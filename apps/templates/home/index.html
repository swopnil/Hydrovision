{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific CSS goes HERE -->

{% block stylesheets %}

    <link rel="stylesheet" href="/static/assets/plugins/chart-morris/css/morris.css">

{% endblock stylesheets %}
{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">


	<script type="text/javascript">
	$(document).ready(function($) 
	{ 

		$(document).on('click', '.btn_print', function(event) 
		{
			event.preventDefault();

			
			var element = document.getElementById('table table-hover'); 

			//easy
			//html2pdf().from(element).save();

			//custom file name
			//html2pdf().set({filename: 'code_with_mark_'+js.AutoCode()+'.pdf'}).from(element).save();


			//more custom settings
			var opt = 
			{
			  margin:       1,
			  filename:     'pageContent_'+js.AutoCode()+'.pdf',
			  image:        { type: 'jpeg', quality: 0.98 },
			  html2canvas:  { scale: 2 },
			  jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
			};

			// New Promise-based usage:
			html2pdf().set(opt).from(element).save();

			 
		});

 
 
	});
</script>

    <div class="pcoded-content">
        <div class="pcoded-inner-content">
            <!-- [ breadcrumb ] start -->

            <!-- [ breadcrumb ] end -->
            <div class="main-body">
                <div class="page-wrapper">
                    <!-- [ Main Content ] start -->
                    <div class="row">
                        <!--[ daily sales section ] start-->
                        <div class="col-md-6 col-xl-4">
                            <div class="card daily-sales">
                                <div class="card-block">
                                    <h6 class="mb-4">Power Generation</h6>
                                    <div class="row d-flex align-items-center">
                                        <div class="col-9">
                                            <h3 class="f-w-300 d-flex align-items-center m-b-0"><i class="feather icon-arrow-up text-c-green f-30 m-r-10"></i>30</h3>
                                        </div>




                                        <div class="col-3 text-right">
                                            <p class="m-b-0">77.3 MW</p>
                                        </div>
                                    </div>
                                    <div class="progress m-t-30" style="height: 7px;">
                                        <div class="progress-bar progress-c-theme" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--[ daily sales section ] end-->
                        <!--[ Monthly  sales section ] starts-->
                        <div class="col-md-6 col-xl-4">
                            <div class="card Monthly-sales">
                                <div class="card-block">
                                    <h6 class="mb-4">Inflow</h6>
                                    <div class="row d-flex align-items-center">
                                        <div class="col-9">
                                            <h3 class="f-w-300 d-flex align-items-center  m-b-0"><i class="feather icon-arrow-down text-c-red f-30 m-r-10"></i>5</h3>
                                        </div>
                                        <div class="col-3 text-right">
                                            <p class="m-b-0">126.3mÂ³/s
                                            </p>
                                        </div>
                                    </div>
                                    <div class="progress m-t-30" style="height: 7px;">
                                        <div class="progress-bar progress-c-theme2" role="progressbar" style="width: 35%;" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--[ Monthly  sales section ] end-->
                        <!--[ year  sales section ] starts-->
                        <div class="col-md-12 col-xl-4">
                            <div class="card yearly-sales">
                                <div class="card-block">
                                    <h6 class="mb-4">Efficiency</h6>
                                    <div class="row d-flex align-items-center">
                                        <div class="col-9">
                                            <h3 class="f-w-300 d-flex align-items-center  m-b-0"><i class="feather icon-arrow-up text-c-green f-30 m-r-10"></i>5</h3>
                                        </div>
                                        <div class="col-3 text-right">
                                            <p class="m-b-0">40%</p>
                                        </div>
                                    </div>
                                    <div class="progress m-t-30" style="height: 7px;">
                                        <div class="progress-bar progress-c-theme" role="progressbar" style="width: 70%;" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--[ year  sales section ] end-->
                        <!--[ Recent Users ] start-->
                        <div class="chart-container">
                            <div class="chart-card">
                                <div class="card-header">
                                    <h5>Generation</h5>
                                    <div class="time-range-buttons" data-chart="morris-bar-stacked-chart">
                                        <button class="time-button" data-range="1D">1D</button>
                                        <button class="time-button" data-range="1W">1W</button>
                                        <button class="time-button active" data-range="1M">1M</button>
                                        <button class="time-button" data-range="1Y">1Y</button>
                                        <button class="time-button" data-range="5Y">5Y</button>
                                    </div>
                                </div>
                                <div class="card-block">
                                    <div class="chart-wrapper">
                                        <div id="morris-bar-stacked-chart"></div>
                                        <div class="legend-box">
                                            <div class="legend-item"><span class="color-box planned"></span>Planned</div>
                                            <div class="legend-item"><span class="color-box actual"></span>Actual</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="card-header">
                                    <h5>Reservoir Level</h5>
                                    <div class="time-range-buttons" data-chart="morris-line-smooth-chart-1">
                                        <button class="time-button" data-range="1D">1D</button>
                                        <button class="time-button" data-range="1W">1W</button>
                                        <button class="time-button active" data-range="1M">1M</button>
                                        <button class="time-button" data-range="1Y">1Y</button>
                                        <button class="time-button" data-range="5Y">5Y</button>
                                    </div>
                                </div>
                                <div class="card-block">
                                    <div class="chart-wrapper">
                                        <div id="morris-line-smooth-chart-1" class="ChartShadow"></div>
                                        <div class="legend-box">
                                            <div class="legend-item"><span class="color-box planned"></span>Planned</div>
                                            <div class="legend-item"><span class="color-box actual"></span>Actual</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="card-header">
                                    <h5>Inflow</h5>
                                    <div class="time-range-buttons" data-chart="morris-line-smooth-chart-2">
                                        <button class="time-button" data-range="1D">1D</button>
                                        <button class="time-button" data-range="1W">1W</button>
                                        <button class="time-button active" data-range="1M">1M</button>
                                        <button class="time-button" data-range="1Y">1Y</button>
                                        <button class="time-button" data-range="5Y">5Y</button>
                                    </div>
                                </div>
                                <div class="card-block">
                                    <div class="chart-wrapper">
                                        <div id="morris-line-smooth-chart-2" class="ChartShadow"></div>
                                        <div class="legend-box">
                                            <div class="legend-item"><span class="color-box planned"></span>Planned</div>
                                            <div class="legend-item"><span class="color-box actual"></span>Actual</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <style>
                        .chart-container {
                            display: flex;
                            flex-direction: column;
                            width: 70%;
                            max-width: 1200px;
                            margin: 0 auto 0 0; /* Changed: Indent to left */
                        }
                        
                        .chart-card {
                            width: 100%;
                            margin-bottom: 30px;
                            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                            border-radius: 8px;
                            overflow: hidden;
                        }
                        
                        .card-header {
                            background-color: #f8f9fa;
                            padding: 15px;
                            border-bottom: 1px solid #e9ecef;
                        }
                        
                        .card-header h5 {
                            margin: 0;
                            font-size: 18px;
                        }
                        
                        .card-block {
                            padding: 20px;
                        }
                        
                        .chart-wrapper {
                            display: flex;
                            align-items: center;
                        }
                        
                        #morris-bar-stacked-chart,
                        #morris-line-smooth-chart-1,
                        #morris-line-smooth-chart-2 {
                            height: 400px;
                            width: calc(100% - 100px);
                        }
                        
                        .ChartShadow {
                            -webkit-filter: drop-shadow(0px 20px 8px rgba(0, 0, 0, 0.2));
                            filter: drop-shadow(0px 20px 8px rgba(0, 0, 0, 0.2));
                        }
                        
                        .time-range-buttons {
                            margin-top: 10px;
                        }
                        
                        .time-button {
                            padding: 5px 10px;
                            margin-right: 5px;
                            border: 1px solid #ddd;
                            background-color: #f8f9fa;
                            cursor: pointer;
                        }
                        
                        .time-button.active {
                            background-color: #007bff;
                            color: white;
                        }
                        
                        .legend-box {
                            width: 100px;
                            padding: 10px;
                            background-color: #f8f9fa;
                            border-radius: 4px;
                            margin-left: 20px;
                        }
                        
                        .legend-item {
                            display: flex;
                            align-items: center;
                            margin-bottom: 5px;
                        }
                        
                        .color-box {
                            width: 20px;
                            height: 20px;
                            margin-right: 10px;
                        }
                        
                        .color-box.planned {
                            background-color: #1de9b6;
                        }
                        
                        .color-box.actual {
                            background-color: #A389D4;
                        }
                        </style>
                        <!--[ Recent Users ] end-->

                        <!-- [ statistics year chart ] start -->

                        <!-- [ statistics year chart ] end -->
                        <!--[social-media section] start-->

                        <!--[social-media section] end-->
                        <!-- [ rating list ] starts-->

                        <!-- [ rating list ] end-->
                       

                    </div>
                    <!-- [ Main Content ] end -->
                </div>
            </div>
        </div>
    </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

    <script src="/static/assets/plugins/chart-morris/js/raphael.min.js"></script>
    <script src="/static/assets/plugins/chart-morris/js/morris.min.js"></script>
    <script src="/static/assets/js/pages/chart-morris-custom.js"></script>
    <!-- First, include the necessary libraries in your HTML -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>

<!-- Then, add this script at the end of your body tag or in a separate JS file -->
<script>


$(document).ready(function() {
    let charts = {};

    function generateData(range) {
        let data = [];
        let date = new Date();
        let increment = {
            '1D': 1000 * 60 * 60, // 1 hour
            '1W': 1000 * 60 * 60 * 24, // 1 day
            '1M': 1000 * 60 * 60 * 24 * 2, // 2 days
            '1Y': 1000 * 60 * 60 * 24 * 30, // 30 days
            '5Y': 1000 * 60 * 60 * 24 * 30 * 3 // 3 months
        };

        let points = {
            '1D': 24,
            '1W': 7,
            '1M': 15,
            '1Y': 12,
            '5Y': 20
        };

        for (let i = 0; i < points[range]; i++) {
            data.unshift({
                y: date.toISOString().slice(0, 10),
                planned: Math.random() * 100,
                actual: Math.random() * 100
            });
            date = new Date(date.getTime() - increment[range]);
        }

        return data;
    }

    function initChart(id, type, range) {
        let config = {
            element: id,
            data: generateData(range),
            xkey: 'y',
            ykeys: ['planned', 'actual'],
            labels: ['Planned', 'Actual'],
            resize: true
        };

        if (type === 'bar') {
            config.stacked = true;
            config.barColors = ['#1de9b6', '#A389D4']; // Add this line for bar chart colors
            return Morris.Bar(config);
        } else {
            config.smooth = true;
            config.lineColors = ['#1de9b6', '#A389D4']; // Move this line inside the else block
            return Morris.Line(config);
        }
    }

    charts['morris-bar-stacked-chart'] = initChart('morris-bar-stacked-chart', 'bar', '1M');
    charts['morris-line-smooth-chart-1'] = initChart('morris-line-smooth-chart-1', 'line', '1M');
    charts['morris-line-smooth-chart-2'] = initChart('morris-line-smooth-chart-2', 'line', '1M');

    $('.time-button').click(function() {
        let range = $(this).data('range');
        let chartId = $(this).closest('.time-range-buttons').data('chart');
        
        $(this).siblings().removeClass('active');
        $(this).addClass('active');

        charts[chartId].setData(generateData(range));
    });
});
</script>

{% endblock javascripts %}
